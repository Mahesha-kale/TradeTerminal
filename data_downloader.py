import yfinance as yf
#import pendulum
import matplotlib.pyplot as plt
import pandas as pd

stklist = ['LEMONTREE.NS', 'EIHOTEL.NS', 'TEJASNET.NS', 'JKPAPER.NS', 'SHARDACROP.NS']#['ECLERX.NS', 'MRPL.NS', 'OLECTRA.NS', 'POLYMED.NS', 'ROUTE.NS', 'ENGINERSIN.NS', 'MEDPLUS.NS', 'NBCC.NS', 'POLICYBZR.NS', 'CERA.NS', 'BALKRISIND.NS', 'MAHLOG.NS', 'PHOENIXLTD.NS', 'SWSOLAR.NS', 'AIAENG.NS', 'RATNAMANI.NS', 'MAXHEALTH.NS', 'KALPATPOWR.NS', 'GLENMARK.NS', 'HINDPETRO.NS', 'INDIANB.NS', 'MAPMYINDIA.NS', 'GRINDWELL.NS', 'NLCINDIA.NS', 'KIMS.NS', 'SYNGENE.NS', 'BALRAMCHIN.NS', 'VARROC.NS', 'BLUEDART.NS', 'ASTERDM.NS', 'GMRINFRA.NS', 'CHALET.NS', 'CEATLTD.NS', 'DCMSHRIRAM.NS', 'IRFC.NS', 'TRITURBINE.NS', 'SUPRAJIT.NS', 'VGUARD.NS', 'IEX.NS', 'OFSS.NS', 'CREDITACC.NS', 'RVNL.NS', 'CHOLAHLDNG.NS', 'WELCORP.NS', 'SUDARSCHEM.NS', 'BLUESTARCO.NS', 'THERMAX.NS', 'PRINCEPIPE.NS', 'ANURAS.NS', 'SAIL.NS', '3MINDIA.NS', 'PGHL.NS', 'RAJESHEXPO.NS', 'MCX.NS', 'AUBANK.NS', 'TORNTPOWER.NS', 'MANYAVAR.NS', 'VOLTAS.NS', 'ASHOKLEY.NS', 'EASEMYTRIP.NS', 'UBL.NS', 'KPITTECH.NS', 'RAMCOCEM.NS', 'JBCHEPHARM.NS', 'YESBANK.NS', 'MFSL.NS', 'NHPC.NS', 'METROBRAND.NS', '360ONE.NS', 'AJANTPHARM.NS', 'MASTEK.NS', 'TEAMLEASE.NS', 'EIHOTEL.NS', 'PFIZER.NS', 'NH.NS', 'ESCORTS.NS', 'TEJASNET.NS', 'MHRIL.NS', 'GPPL.NS', 'JYOTHYLAB.NS', 'LUPIN.NS', 'KAJARIACER.NS', 'ABB.NS', 'MAHLIFE.NS', 'GAEL.NS', 'UTIAMC.NS', 'KNRCON.NS', 'GLAXO.NS', 'SOLARINDS.NS', 'WESTLIFE.NS', 'SANOFI.NS', 'MRF.NS', 'SUNDARMFIN.NS', 'VIPIND.NS', 'IPCALAB.NS', 'SHOPERSTOP.NS', 'HLEGLAS.NS', 'MOIL.NS', 'GOCOLORS.NS', 'JUBLINGREA.NS', 'SUPREMEIND.NS', 'FORTIS.NS', 'SIS.NS', 'VINATIORGA.NS', 'SUMICHEM.NS', 'IGL.NS', 'AETHER.NS', 'BHARATFORG.NS', 'BAYERCROP.NS', 'CESC.NS', 'TRIVENI.NS', 'BSOFT.NS', 'GUJGASLTD.NS', 'ABBOTINDIA.NS', 'RADICO.NS', 'HOMEFIRST.NS', 'NOCIL.NS', 'FINCABLES.NS', 'FEDERALBNK.NS', 'CAPLIPOINT.NS', 'KPRMILL.NS', 'RTNINDIA.NS', 'BEML.NS', 'HEG.NS', 'EDELWEISS.NS', 'EXIDEIND.NS', 'JKPAPER.NS', 'COROMANDEL.NS', 'ABSLAMC.NS', 'RENUKA.NS', 'ENDURANCE.NS', 'MAHABANK.NS', 'PRESTIGE.NS', 'MOTILALOFS.NS', 'NUVOCO.NS', 'MGL.NS', 'GODREJIND.NS', 'BHEL.NS', 'JKCEMENT.NS', 'AUROPHARMA.NS', 'RAYMOND.NS', 'KRBL.NS', 'BRIGADE.NS', 'CYIENT.NS', 'ASTRAL.NS', 'GSFC.NS', 'ORIENTELEC.NS', 'RAIN.NS', 'ALKEM.NS', 'BAJAJELEC.NS', 'LICHSGFIN.NS', 'CSBBANK.NS', 'VMART.NS', 'GRAPHITE.NS', 'RITES.NS', 'DALBHARAT.NS', 'RHIM.NS', 'TATACOMM.NS', 'ASTRAZEN.NS', 'POONAWALLA.NS', 'IBREALEST.NS', 'MMTC.NS', 'CHAMBLFERT.NS', 'INDOCO.NS', 'SHYAMMETL.NS', 'RALLIS.NS', 'JMFINANCIL.NS', 'MTARTECH.NS', 'HONAUT.NS', 'DBL.NS', 'CHEMPLASTS.NS', 'CASTROLIND.NS', 'SKFINDIA.NS', 'INFIBEAM.NS', 'REDINGTON.NS', 'NETWORK18.NS', 'HINDCOPPER.NS', 'INDHOTEL.NS', 'NIACL.NS', 'OBEROIRLTY.NS', 'AMBER.NS', 'BIRLACORPN.NS', 'JAMNAAUTO.NS', 'GICRE.NS', 'KEI.NS', 'TCIEXP.NS', 'TVSMOTOR.NS', 'RCF.NS', 'MANAPPURAM.NS', 'IDBI.NS', 'JUSTDIAL.NS', 'NAZARA.NS', 'APLAPOLLO.NS', 'IBULHSGFIN.NS', 'SHRIRAMFIN.NS', 'IDFCFIRSTB.NS', 'CANFINHOME.NS', 'PNB.NS', 'TIINDIA.NS', 'SCHAEFFLER.NS', 'UNOMINDA.NS', 'CGCL.NS', 'BBTC.NS', 'BDL.NS', 'LATENTVIEW.NS', 'FSL.NS', 'AAVAS.NS', 'STLTECH.NS', 'GRINFRA.NS', 'SONACOMS.NS', 'EPL.NS', 'KARURVYSYA.NS', 'POWERINDIA.NS', 'HUDCO.NS', 'HGS.NS', 'RBLBANK.NS', 'TV18BRDCST.NS', 'HIKAL.NS', 'COFORGE.NS', 'ZFCVINDIA.NS', 'VAIBHAVGBL.NS', 'BASF.NS', 'ZENSARTECH.NS', 'LODHA.NS', 'IIFL.NS', 'INTELLECT.NS', 'BANKINDIA.NS', 'CANBK.NS', 'GODFRYPHLP.NS', 'INDIAMART.NS', 'SUZLON.NS', 'SHILPAMED.NS', 'POLYCAB.NS', 'EQUITASBNK.NS']#["ECLERX.NS","MRPL.NS","SWANENERGY.NS","OLECTRA.NS","JBMA.NS","POLYMED.NS","PRSMJOHNSN.NS","ROUTE.NS","ENGINERSIN.NS","LEMONTREE.NS","DIXON.NS","GREENPANEL.NS","MEDPLUS.NS","ZYDUSWELL.NS","NBCC.NS","POLICYBZR.NS","ANGELONE.NS","CERA.NS","BALKRISIND.NS","MAHLOG.NS","PHOENIXLTD.NS","SWSOLAR.NS","AIAENG.NS","RATNAMANI.NS","ZYDUSLIFE.NS","MAXHEALTH.NS","KALPATPOWR.NS","PNCINFRA.NS","GLENMARK.NS","NAM-INDIA.NS","JSL.NS","TTKPRESTIG.NS","CDSL.NS","APTUS.NS","HINDPETRO.NS","THYROCARE.NS","IFBIND.NS","INDIANB.NS","MAPMYINDIA.NS","GRINDWELL.NS","NLCINDIA.NS","KIMS.NS","SYNGENE.NS","BALRAMCHIN.NS","VARROC.NS","WELSPUNIND.NS","BLUEDART.NS","ASTERDM.NS","GMRINFRA.NS","CHALET.NS","CEATLTD.NS","DCMSHRIRAM.NS","RELAXO.NS","IRFC.NS","TRITURBINE.NS","SUPRAJIT.NS","LUXIND.NS","PAGEIND.NS","CAMPUS.NS","VGUARD.NS","IEX.NS","OFSS.NS","CREDITACC.NS","PETRONET.NS","DEEPAKNTR.NS","TRIDENT.NS","EMAMILTD.NS","RVNL.NS","TRENT.NS","NCC.NS","CHOLAHLDNG.NS","ATUL.NS","WELCORP.NS","STARHEALTH.NS","CENTURYTEX.NS","SUDARSCHEM.NS","BLUESTARCO.NS","THERMAX.NS","PRINCEPIPE.NS","ANURAS.NS","SAIL.NS","KANSAINER.NS","GMMPFAUDLR.NS","3MINDIA.NS","PGHL.NS","RAJESHEXPO.NS","MCX.NS","AUBANK.NS","DEEPAKFERT.NS","IRB.NS","ELGIEQUIP.NS","TORNTPOWER.NS","MANYAVAR.NS","GARFIBRES.NS","MSUMI.NS","VOLTAS.NS","ASHOKLEY.NS","EASEMYTRIP.NS","UBL.NS","FLUOROCHEM.NS","COCHINSHIP.NS","EIDPARRY.NS","KPITTECH.NS","RAMCOCEM.NS","JINDALSTEL.NS","JBCHEPHARM.NS","YESBANK.NS","RBA.NS","AMARAJABAT.NS","MFSL.NS","NHPC.NS","METROBRAND.NS","ABFRL.NS","JSWENERGY.NS","360ONE.NS","AJANTPHARM.NS","MASTEK.NS","VBL.NS","TEAMLEASE.NS","EIHOTEL.NS","CUMMINSIND.NS","PFIZER.NS","ALKYLAMINE.NS","NH.NS","CCL.NS","AEGISCHEM.NS","SUVENPHAR.NS","ESCORTS.NS","TEJASNET.NS","MHRIL.NS","GPPL.NS","JYOTHYLAB.NS","LUPIN.NS","GODREJAGRO.NS","KAJARIACER.NS","TIMKEN.NS","ABB.NS","MAHLIFE.NS","GAEL.NS","UTIAMC.NS","CGPOWER.NS","KNRCON.NS","CARBORUNIV.NS","SUNTECK.NS","WHIRLPOOL.NS","GALAXYSURF.NS","GLAXO.NS","SOLARINDS.NS","WESTLIFE.NS","SANOFI.NS","MRF.NS","SUNDARMFIN.NS","VIPIND.NS","IPCALAB.NS","TCI.NS","SHOPERSTOP.NS","BATAINDIA.NS","HLEGLAS.NS","MOIL.NS","GOCOLORS.NS","SUNDRMFAST.NS","JUBLINGREA.NS","SUPREMEIND.NS","CRISIL.NS","FORTIS.NS","SIS.NS","VINATIORGA.NS","JUBLPHARMA.NS","QUESS.NS","TATAELXSI.NS","LXCHEM.NS","SUMICHEM.NS","INDIGOPNTS.NS","IGL.NS","AETHER.NS","APOLLOTYRE.NS","BHARATFORG.NS","WOCKPHARMA.NS","BAYERCROP.NS","HAPPSTMNDS.NS","CAMS.NS","CESC.NS","GODREJPROP.NS","FINEORG.NS","TRIVENI.NS","BSOFT.NS","GUJGASLTD.NS","ABBOTINDIA.NS","CENTURYPLY.NS","RADICO.NS","NATIONALUM.NS","HOMEFIRST.NS","ROSSARI.NS","NOCIL.NS","FINCABLES.NS","BALAMINES.NS","FEDERALBNK.NS","CAPLIPOINT.NS","KPRMILL.NS","KEC.NS","RTNINDIA.NS","BEML.NS","HEG.NS","VIJAYA.NS","PFC.NS","EDELWEISS.NS","EXIDEIND.NS","JKPAPER.NS","ZEEL.NS","COROMANDEL.NS","ABSLAMC.NS","RENUKA.NS","ISEC.NS","IDEA.NS","SFL.NS","ENDURANCE.NS","MAHABANK.NS","PRESTIGE.NS","MOTILALOFS.NS","ALOKINDS.NS","NAVINFLUOR.NS","NUVOCO.NS","MGL.NS","GODREJIND.NS","BHEL.NS","JKCEMENT.NS","MAHINDCIE.NS","AUROPHARMA.NS","RAYMOND.NS","KRBL.NS","LINDEINDIA.NS","BHARATRAS.NS","BRIGADE.NS","CYIENT.NS","CROMPTON.NS","ASTRAL.NS","GSFC.NS","ORIENTELEC.NS","GUJALKALI.NS","RAIN.NS","TANLA.NS","ALKEM.NS","BAJAJELEC.NS","TATACHEM.NS","CENTRALBK.NS","SUNTV.NS","PRAJIND.NS","AFFLE.NS","POLYPLEX.NS","CLEAN.NS","JKLAKSHMI.NS","LICHSGFIN.NS","TATACOFFEE.NS","IOB.NS","TATAINVEST.NS","CSBBANK.NS","VMART.NS","GRAPHITE.NS","RITES.NS","DALBHARAT.NS","VTL.NS","RHIM.NS","TATACOMM.NS","ASTRAZEN.NS","POONAWALLA.NS","NATCOPHARM.NS","IBREALEST.NS","SOBHA.NS","MMTC.NS","FINPIPE.NS","CHAMBLFERT.NS","INDOCO.NS","ITI.NS","SHYAMMETL.NS","RALLIS.NS","JMFINANCIL.NS","MTARTECH.NS","HONAUT.NS","DBL.NS","LTTS.NS","CHEMPLASTS.NS","HATSUN.NS","CASTROLIND.NS","APLLTD.NS","SKFINDIA.NS","INFIBEAM.NS","REDINGTON.NS","NETWORK18.NS","DHANI.NS","UCOBANK.NS","HINDCOPPER.NS","INDHOTEL.NS","NIACL.NS","OBEROIRLTY.NS","SJVN.NS","AMBER.NS","PERSISTENT.NS","BSE.NS","ASAHIINDIA.NS","LAXMIMACH.NS","FACT.NS","BIRLACORPN.NS","JAMNAAUTO.NS","AVANTIFEED.NS","UFLEX.NS","GICRE.NS","SPARC.NS","KEI.NS","TCIEXP.NS","SHARDACROP.NS","PVR.NS","TVSMOTOR.NS","JUBLFOOD.NS","MAZDOCK.NS","RCF.NS","MANAPPURAM.NS","IDBI.NS","JUSTDIAL.NS","BORORENEW.NS","CONCOR.NS","LAURUSLABS.NS","NAZARA.NS","CUB.NS","FDC.NS","ABCAPITAL.NS","GSPL.NS","PCBL.NS","APLAPOLLO.NS","IBULHSGFIN.NS","SHRIRAMFIN.NS","IDFCFIRSTB.NS","CANFINHOME.NS","PNB.NS","TIINDIA.NS","SCHAEFFLER.NS","UNOMINDA.NS","KALYANKJIL.NS","CGCL.NS","BBTC.NS","BDL.NS","LATENTVIEW.NS","DEVYANI.NS","FSL.NS","L&TFH.NS","SAPPHIRE.NS","AAVAS.NS","STLTECH.NS","GRINFRA.NS","HFCL.NS","BCG.NS","SONACOMS.NS","EPL.NS","UNIONBANK.NS","IDFC.NS","GESHIP.NS","M&MFIN.NS","PATANJALI.NS","INDIACEM.NS","KARURVYSYA.NS","SYMPHONY.NS","METROPOLIS.NS","HINDZINC.NS","GNFC.NS","OIL.NS","RAINBOW.NS","POWERINDIA.NS","RECLTD.NS","HUDCO.NS","HGS.NS","LALPATHLAB.NS","RBLBANK.NS","TV18BRDCST.NS","HIKAL.NS","COFORGE.NS","PRIVISCL.NS","ZFCVINDIA.NS","VAIBHAVGBL.NS","GRANULES.NS","BASF.NS","ZENSARTECH.NS","TCNSBRANDS.NS","LODHA.NS","PPLPHARMA.NS","IIFL.NS","INTELLECT.NS","PNBHOUSING.NS","AARTIDRUGS.NS","BANKINDIA.NS","CANBK.NS","TTML.NS","DELTACORP.NS","GODFRYPHLP.NS","INDIAMART.NS","DELHIVERY.NS","SUZLON.NS","SHILPAMED.NS","POLYCAB.NS","SONATSOFTW.NS","AWL.NS","EQUITASBNK.NS"]
picks = []

for inde,stk in enumerate(stklist):
    print(f"{inde}) chekking>>>>{stk}")
    #cnt = 0
    price_history_daily = yf.Ticker(stk).history(period='max', # valid periods: 1d,5d,1mo,3mo,6mo,1y,2y,5y,10y,ytd,max
                                                interval='1D', # valid intervals: 1m,2m,5m,15m,30m,60m,90m,1h,1d,5d,1wk,1mo,3mo
                                                actions=False)
    # time_series_daily_close = list(price_history_daily['Close'])
    #time_series_daily_open = list(price_history_daily['Open'])
    #days_200 = time_series_daily_close[-200:]
    with open(f"CSV_Files\\{stk}.csv", 'w') as writer:
        price_history_daily.to_csv(writer, index=True)
    print(f"Downloaded {stk}")
    
